SELECT
  w.LSOA_CODE AS lsoa_code,
  w.YEAR AS year,
  w.DATA_SOURCE AS water_company,
  w.TOTAL_CONSUMPTION AS consumption,
  l.region_code,l.region_name,
  h.avg_homeworking_rate
FROM water_data AS w
LEFT JOIN dim_location AS l
  ON w.LSOA_CODE = l.lsoa_code
LEFT JOIN dim_homeworking AS h
  ON l.region_code = h.region_code
  AND w.YEAR = h.year
ORDER BY l.region_code, w.YEAR, w.LSOA_CODE;